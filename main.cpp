#include <iostream>
#include <string>
#include <cstring>
/***********************************************************************
* Program:
*    Lab 068, Vulnerabilities & Exploits
*    Brother Helfrich, CS 370
* Author:
*    John Miller
*    Bretton Steiner
*	   Ben Smith
*    Tyler Starr
*
* Summary:
*    Enter a brief description of your program here!
 ************************************************************************/

/*************************************
 * ARRAY VULNERABILTY
 * 1. There must be an array and an array index variable
 * 2. The array index variable must be reachable through external input.
 * 3. There must not be bounds checking on the array index variable.
 ****************************************/
void arrayVulnerability(/* feel free to add parameters */)
{
}

/**************************************
 * ARRAY WORKING
 * Call arrayVulnerability() in a way that does
 * not yield unexpected behavior
 *************************************/
void arrayWorking()
{
   arrayVulnerability(/* parameters with non-malicious data */);
}

/**************************************
 * ARRAY EXPLOIT
 * 1. The attacker provides an array index value outside the expected range
 * 2. The attacker must be able to provide input or redirect
 *    existing input into the array at the index he provided
 * 3. The injected value must alter program state in a way
 *    that is desirable to the attacker
 *************************************/
void arrayExploit()
{
   arrayVulnerability(/* parameters with malicious data */);
}



/*************************************
 * ARC INJECTION VULNERABILITY
 ****************************************/
void arcVulnerability(/* feel free to add parameters */)
{
}

/**************************************
 * ARC INJECTION WORKING
 *************************************/
void arcWorking()
{
   arcVulnerability(/* parameters with non-malicious data */);
}

/**************************************
 * ARC INJECTION EXPLOIT
 *************************************/
void arcExploit()
{
   arcVulnerability(/* parameters with malicious data */);
}



/**************************************
 * VTABLE VULNERABILITY
 *************************************/
class Vulnerability
{
   /* methods that are vulnerable */
};

/**************************************
 * VTABLE WORKING
 *************************************/
void vtableWorking()
{
   Vulnerability obj;
   /* calls the object method non-maliciously */
}

/**************************************
 * VTABLE EXPLOIT
 *************************************/
void vtableExploit()
{
   Vulnerability obj;
   /* calls the object method maliciously */
}


/*************************************
 * STACK SMASHING VULNERABILITY
 ****************************************/
void stackVulnerability(/* feel free to add parameters */)
{
}

/**************************************
 * STACK SMASHING WORKING
 *************************************/
void stackWorking()
{
   stackVulnerability(/* parameters with non-malicious data */);
}

/**************************************
 * STACK SMASHING EXPLOIT
 *************************************/
void stackExploit()
{
   stackVulnerability(/* parameters with malicious data */);
}


/*************************************
 * HEAP SPRAYING VULNERABILITY
 * 1. There must be two adjacent heap buffers
 * 2. The first buffer must be reachable through external input
 * 3. Must not check correctly for buffer size
 * 4. The second buffer must be released before the first
 ****************************************/
void heapVulnerability(char* input)
{
   char* p1 = new char[8];
   char* p2 = new char[8];

   strcpy(p2, "Safe");
   strcpy(p1, input);

   std::cout << "p2: " << p2 << '\n';

   delete[] p2;

   delete[] p1;
}

/**************************************
 * HEAP SPRAYING WORKING
 *************************************/
void heapWorking()
{
   heapVulnerability("Good");
}

/**************************************
 * HEAP SPRAYING EXPLOIT
 *************************************/
void heapExploit()
{
   // The AAAs will go into the p1 allocation.
   // The hhhs will overwrite the MCB.
   // The 123s overwrite the p2 allocation.
   heapVulnerability("AAAAAAAAhhhhhhhh1234567890");
}



/*************************************
 * INTEGER OVERFLOW VULNERABILITY
 ****************************************/
void intVulnerability(/* feel free to add parameters */)
{
}

/**************************************
 * INTEGER OVERFLOW WORKING
 *************************************/
void intWorking()
{
   intVulnerability(/* parameters with non-malicious data */);
}

/**************************************
 * INTEGER OVERFLOW EXPLOIT
 *************************************/
void intExploit()
{
   intVulnerability(/* parameters with malicious data */);
}



/*************************************
 * ANSI-UNICODE VULNERABILITY
 ****************************************/
void ansiVulnerability(/* feel free to add parameters */)
{
}

/**************************************
 * ANSI-UNICODE WORKING
 *************************************/
void ansiWorking()
{
   stackVulnerability(/* parameters with non-malicious data */);
}

/**************************************
 * ANSI-UNICODE EXPLOIT
 *************************************/
void ansiExploit()
{
   ansiVulnerability(/* parameters with malicious data */);
}



/***********************************************************************
* Function:
*    main()
* Inputs: none
* Summary:
*    Driver function for the program.
 ************************************************************************/
int main()
{

  heapWorking();
  heapExploit();

  return 0;
}	
